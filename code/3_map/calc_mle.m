
X = [0 1 0 1 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0
     0 0 0 1 0 0 1 0 1 1 0 1 1 0 0 0 0 0 0 0 0
     0 1 0 1 0 0 1 0 0 1 0 0 0 0 0 0 1 0 0 0 0
     0 0 0 1 0 0 0 0 1 1 0 0 1 1 1 1 0 0 0 0 0
     0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1];
y = [1;1;1;1;2];

L6 = [1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
X
y

p = zeros(2,size(X,2));

for k = 1:size(p,1)
    for l = 1:size(p,2)
        X_t = X(y == k, l);
        p_jk = size(X_t(X_t == 1),1) / size(X_t,1);
        p(k, l) = p_jk;
    end 
end

p
p_L6 = 0.8;
for k = 1:size(p_L6,2)
    if L6(k) == 1
        p_L6 = p_L6 * p(1,k);
    else
        p_L6 = p_L6 * (1-p(1,k));
    end
end

p_L6